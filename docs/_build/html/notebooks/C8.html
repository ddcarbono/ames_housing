
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Capítulo 8: Validación y selección del modelo &#8212; Ames Housing: Regresión lineal, inferencia, diagnóstico y métodos robustos</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"TeX": {"equationNumbers": {"autoNumber": "all"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/C8';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Capítulo 7: Remedios y métodos robustos" href="C7.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Ames Housing: Regresión lineal, inferencia, diagnóstico y métodos robustos</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="C2.html">Capítulo 2: Descripción y limpieza del dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="C3.html">Capítulo 3: Análisis exploratorio (EDA)</a></li>
<li class="toctree-l1"><a class="reference internal" href="C4.html">Capítulo 4: Formulación matricial del modelo OLS</a></li>
<li class="toctree-l1"><a class="reference internal" href="C5.html">Capítulo 5: Inferencia y grados de libertad</a></li>
<li class="toctree-l1"><a class="reference internal" href="C6.html">Capítulo 6: Diagnóstico de supuestos</a></li>
<li class="toctree-l1"><a class="reference internal" href="C7.html">Capítulo 7: Remedios y métodos robustos</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Capítulo 8: Validación y selección del modelo</a></li>

</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/C8.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Capítulo 8: Validación y selección del modelo</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Capítulo 8: Validación y selección del modelo</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#validacion-train-test">8.1 Validación train/test</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-ridge">8.2 Regresión Ridge</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-lasso">8.3 Regresión Lasso</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ols-vs-ridge-vs-lasso">8.4 OLS vs. Ridge vs. Lasso</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="capitulo-8-validacion-y-seleccion-del-modelo">
<h1>Capítulo 8: Validación y selección del modelo<a class="headerlink" href="#capitulo-8-validacion-y-seleccion-del-modelo" title="Link to this heading">#</a></h1>
<section id="validacion-train-test">
<h2>8.1 Validación train/test<a class="headerlink" href="#validacion-train-test" title="Link to this heading">#</a></h2>
<p>Al evaluar un modelo de regresión, es fundamental medir qué tan bien predice datos que no ha visto durante su entrenamiento. Para ello, se suele dividir el conjunto de datos en dos partes: <strong>entrenamiento (train)</strong> y <strong>prueba (test)</strong>, donde el primero se utiliza para ajustar los parámetros del modelo y aprender patrones en los datos, y el de prueba se reserva para evaluar la capacidad de generalización del modelo, es decir, qué tan bien puede predecir datos nuevos.</p>
<p>De esta forma es posible detectar problemas como el <strong>sobreajuste</strong> (overfitting), donde el modelo se ajusta demasiado a los datos de entrenamiento y falla al generalizar.</p>
<p>Para cuantificar este desempeño se utilizan métricas de error y de ajuste. Las más comunes son <strong>R²</strong>, <strong>RMSE</strong> y <strong>MAE</strong>.</p>
<p>El <strong>coeficiente de determinación (R²)</strong> mide la proporción de la varianza de la variable dependiente (y) que es explicada por el modelo:</p>
<div class="math notranslate nohighlight">
\[
R^2 = 1 - \frac{\sum_{i=1}^{n} (y_i - \hat{y}_i)^2}{\sum_{i=1}^{n} (y_i - \bar{y})^2}
\]</div>
<p><strong>Ecuación 8.1.1.</strong> Coeficiente de determinación.</p>
<p>Un R² cercano a 1 indica un buen ajuste, mientras que un valor cercano a 0 indica que el modelo no explica la variabilidad de los datos.</p>
<p>Por su parte, la <strong>raíz del error cuadrático medio (RMSE)</strong> se interpreta como el error promedio en las mismas unidades que la variable (y), con mayor sensibilidad a errores grandes:</p>
<div class="math notranslate nohighlight">
\[
\text{RMSE} = \sqrt{\frac{1}{n} \sum_{i=1}^{n} (y_i - \hat{y}_i)^2}
\]</div>
<p><strong>Ecuación 8.1.2.</strong> Raíz del error cuadrático medio.</p>
<p>Esta métrica penaliza más los errores grandes.</p>
<p>El <strong>error absoluto medio (MAE)</strong> es el promedio de los errores absolutos, es decir, indica en promedio cuánto se desvía la predicción de los valores reales:</p>
<div class="math notranslate nohighlight">
\[
\text{MAE} = \frac{1}{n} \sum_{i=1}^{n} |y_i - \hat{y}_i|
\]</div>
<p><strong>Ecuación 8.1.3.</strong> Error absoluto medio.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">r2_score</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">statsmodels.api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>

<span class="n">data_modelo_base</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../data/AmesHousing_codificada.csv&quot;</span><span class="p">)</span>

<span class="n">data_modelo_base</span> <span class="o">=</span> <span class="n">data_modelo_base</span><span class="p">[[</span><span class="s1">&#39;SalePrice_log&#39;</span><span class="p">,</span> <span class="s1">&#39;Overall Qual&#39;</span><span class="p">,</span> <span class="s1">&#39;Gr Liv Area&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;Garage Cars&#39;</span><span class="p">,</span> <span class="s1">&#39;Total Bsmt SF&#39;</span><span class="p">,</span> <span class="s1">&#39;1st Flr SF&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;Full Bath&#39;</span><span class="p">,</span> <span class="s1">&#39;Year Built&#39;</span><span class="p">,</span> <span class="s1">&#39;Fireplaces&#39;</span><span class="p">,</span> <span class="s1">&#39;Lot Area&#39;</span><span class="p">]]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">data_modelo_base</span><span class="p">[[</span><span class="s1">&#39;Overall Qual&#39;</span><span class="p">,</span> <span class="s1">&#39;Gr Liv Area&#39;</span><span class="p">,</span> <span class="s1">&#39;Garage Cars&#39;</span><span class="p">,</span> <span class="s1">&#39;Total Bsmt SF&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;1st Flr SF&#39;</span><span class="p">,</span> <span class="s1">&#39;Full Bath&#39;</span><span class="p">,</span> <span class="s1">&#39;Year Built&#39;</span><span class="p">,</span> <span class="s1">&#39;Fireplaces&#39;</span><span class="p">,</span> <span class="s1">&#39;Lot Area&#39;</span><span class="p">]]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data_modelo_base</span><span class="p">[[</span><span class="s1">&#39;SalePrice_log&#39;</span><span class="p">]]</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_train_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">X_train_scaled_const</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">)</span>
<span class="n">X_test_scaled_const</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">evaluar_modelo</span><span class="p">(</span><span class="n">modelo</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
    <span class="n">modelo_fit</span> <span class="o">=</span> <span class="n">modelo</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">X_train</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
    
    <span class="n">y_pred_train</span> <span class="o">=</span> <span class="n">modelo_fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">y_pred_test</span> <span class="o">=</span> <span class="n">modelo_fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    
    <span class="n">r2_train</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred_train</span><span class="p">)</span>
    <span class="n">rmse_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred_train</span><span class="p">))</span>
    <span class="n">mae_train</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred_train</span><span class="p">)</span>

    <span class="n">r2_test</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_test</span><span class="p">)</span>
    <span class="n">rmse_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_test</span><span class="p">))</span>
    <span class="n">mae_test</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_test</span><span class="p">)</span>
    
    <span class="n">overfit</span> <span class="o">=</span> <span class="n">r2_train</span> <span class="o">-</span> <span class="n">r2_test</span>

    <span class="n">resultados</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
        <span class="s1">&#39;Conjunto&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Entrenamiento&#39;</span><span class="p">,</span> <span class="s1">&#39;Prueba&#39;</span><span class="p">],</span>
        <span class="s1">&#39;R2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">r2_train</span><span class="p">,</span> <span class="n">r2_test</span><span class="p">],</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">rmse_train</span><span class="p">,</span> <span class="n">rmse_test</span><span class="p">],</span>
        <span class="s1">&#39;MAE&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">mae_train</span><span class="p">,</span> <span class="n">mae_test</span><span class="p">],</span>
        <span class="s1">&#39;Overfitting_R2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">overfit</span><span class="p">,</span> <span class="n">overfit</span><span class="p">]</span>
    <span class="p">})</span>
    
    <span class="k">return</span> <span class="n">resultados</span><span class="p">,</span> <span class="n">y_pred_train</span><span class="p">,</span> <span class="n">y_pred_test</span>

<span class="n">resultados_eval_ols</span><span class="p">,</span> <span class="n">y_pred_train</span><span class="p">,</span> <span class="n">y_pred_test</span> <span class="o">=</span> <span class="n">evaluar_modelo</span><span class="p">(</span>
    <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">,</span> <span class="n">X_train_scaled_const</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test_scaled_const</span><span class="p">,</span> <span class="n">y_test</span>
<span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">resultados_eval_ols</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Conjunto</th>
      <th>R2</th>
      <th>RMSE</th>
      <th>MAE</th>
      <th>Overfitting_R2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Entrenamiento</td>
      <td>0.848465</td>
      <td>0.146211</td>
      <td>0.102470</td>
      <td>-0.006788</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Prueba</td>
      <td>0.855252</td>
      <td>0.145456</td>
      <td>0.105587</td>
      <td>-0.006788</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Tabla 8.1.1.</strong> Validación train/test modelo 1.</p>
<p>Los resultados indican que, en el conjunto de entrenamiento, el modelo es capaz de explicar aproximadamente un 84.8% de la variabilidad total de los datos. En el conjunto de prueba, este valor aumenta ligeramente a 85.5%, lo que sugiere que el modelo tiene una buena capacidad de generalización y no está sobreajustado a los datos de entrenamiento.</p>
<p>En cuanto a los errores, tanto el RMSE como el MAE presentan valores muy similares entre entrenamiento y prueba. Esto indica que el modelo mantiene un buen nivel de precisión al predecir datos no vistos.</p>
</section>
<section id="regresion-ridge">
<h2>8.2 Regresión Ridge<a class="headerlink" href="#regresion-ridge" title="Link to this heading">#</a></h2>
<p>La <strong>regresión Ridge</strong> es una extensión de la regresión lineal que incorpora un término de regularización L2 para controlar el sobreajuste y estabilizar los coeficientes cuando existe <strong>colinealidad</strong> entre las variables predictoras.</p>
<p>La función de pérdida de Ridge modifica la función de mínimos cuadrados para incluir la penalización sobre los coeficientes:</p>
<div class="math notranslate nohighlight">
\[
S_{\text{Ridge}}(\beta) = (Y - X \beta)^\top (Y - X \beta) + \alpha \, \beta^\top \beta
\]</div>
<p><strong>Ecuación 8.2.1.</strong> Función de pérdida Ridge.</p>
<p>Donde <span class="math notranslate nohighlight">\( \alpha \ge 0 \)</span> es el hiperparámetro de regularización.</p>
<p>Al introducir esta penalización, se <strong>reduce la varianza de los coeficientes</strong>, evitando que tomen valores excesivamente grandes y mejorando la <strong>capacidad de generalización</strong> del modelo. Si <span class="math notranslate nohighlight">\( \alpha = 0 \)</span>, esta solución se reduce a la regresión lineal ordinaria (<a class="reference internal" href="#ecuacion-411-regresion-lineal"><span class="xref myst">Ecuación 4.1.1</span></a>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ridge</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">r2_score</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_error</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../data/AmesHousing_codificada.csv&quot;</span><span class="p">)</span>

<span class="n">vars_modelo</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;Overall Qual&#39;</span><span class="p">,</span> <span class="s1">&#39;Gr Liv Area&#39;</span><span class="p">,</span> <span class="s1">&#39;Garage Cars&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Total Bsmt SF&#39;</span><span class="p">,</span> <span class="s1">&#39;1st Flr SF&#39;</span><span class="p">,</span> <span class="s1">&#39;Full Bath&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Year Built&#39;</span><span class="p">,</span> <span class="s1">&#39;Fireplaces&#39;</span><span class="p">,</span> <span class="s1">&#39;Lot Area&#39;</span>
<span class="p">]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">vars_modelo</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;SalePrice_log&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_train_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">X_train_int</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train_int</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tamaños -&gt; Train: </span><span class="si">{</span><span class="n">X_train_int</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, Validación: </span><span class="si">{</span><span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, Test final: </span><span class="si">{</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tamaños -&gt; Train: 1549, Validación: 388, Test final: 831
</pre></div>
</div>
</div>
</div>
<p><strong>Tabla 8.2.1.</strong> Tamaños validación Ridge.</p>
<p>El conjunto de entrenamiento cuenta con 1 549 observaciones y se utiliza para ajustar los parámetros del modelo y aprender los patrones de los datos; el conjunto de validación tiene 388 observaciones y permite ajustar hiperparámetros y evaluar el desempeño del modelo durante el entrenamiento sin utilizar los datos de prueba; el conjunto de prueba final posee 831 observaciones y se reserva exclusivamente para evaluar la capacidad de generalización del modelo, es decir, su desempeño en datos que no han sido vistos previamente, asegurando así un flujo de trabajo robusto y confiable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>
<span class="n">resultados</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">alphas</span><span class="p">:</span>
    <span class="n">ridge</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
    <span class="n">ridge</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_int</span><span class="p">,</span> <span class="n">y_train_int</span><span class="p">)</span>
  
    <span class="n">y_val_pred</span> <span class="o">=</span> <span class="n">ridge</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
    <span class="n">r2_val</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred</span><span class="p">)</span>
    <span class="n">rmse_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred</span><span class="p">))</span>
    <span class="n">mae_val</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred</span><span class="p">)</span>
    
    <span class="n">resultados</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">alpha</span><span class="p">,</span> <span class="n">r2_val</span><span class="p">,</span> <span class="n">rmse_val</span><span class="p">,</span> <span class="n">mae_val</span><span class="p">))</span>

<span class="n">resultados_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">,</span> <span class="s2">&quot;R2_val&quot;</span><span class="p">,</span> <span class="s2">&quot;RMSE_val&quot;</span><span class="p">,</span> <span class="s2">&quot;MAE_val&quot;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">resultados_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>alpha</th>
      <th>R2_val</th>
      <th>RMSE_val</th>
      <th>MAE_val</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.001000</td>
      <td>0.885697</td>
      <td>0.123939</td>
      <td>0.094524</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.003162</td>
      <td>0.885697</td>
      <td>0.123939</td>
      <td>0.094523</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.010000</td>
      <td>0.885697</td>
      <td>0.123939</td>
      <td>0.094523</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.031623</td>
      <td>0.885697</td>
      <td>0.123939</td>
      <td>0.094523</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.100000</td>
      <td>0.885698</td>
      <td>0.123939</td>
      <td>0.094522</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.316228</td>
      <td>0.885699</td>
      <td>0.123938</td>
      <td>0.094520</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1.000000</td>
      <td>0.885702</td>
      <td>0.123937</td>
      <td>0.094512</td>
    </tr>
    <tr>
      <th>7</th>
      <td>3.162278</td>
      <td>0.885711</td>
      <td>0.123932</td>
      <td>0.094488</td>
    </tr>
    <tr>
      <th>8</th>
      <td>10.000000</td>
      <td>0.885729</td>
      <td>0.123922</td>
      <td>0.094414</td>
    </tr>
    <tr>
      <th>9</th>
      <td>31.622777</td>
      <td>0.885694</td>
      <td>0.123941</td>
      <td>0.094215</td>
    </tr>
    <tr>
      <th>10</th>
      <td>100.000000</td>
      <td>0.884890</td>
      <td>0.124376</td>
      <td>0.094155</td>
    </tr>
    <tr>
      <th>11</th>
      <td>316.227766</td>
      <td>0.879057</td>
      <td>0.127489</td>
      <td>0.096211</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1000.000000</td>
      <td>0.853320</td>
      <td>0.140399</td>
      <td>0.106445</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Tabla 8.2.2.</strong> Evaluación de valores de penalización Ridge.</p>
<p>Se observa que para los valores pequeños de <span class="math notranslate nohighlight">\( \alpha\ \)</span> probados (0.001 a 10), las métricas de validación son prácticamente constantes, con un <strong>R²</strong> cercano a 0.8857, un <strong>RMSE</strong> alrededor de 0.1239 y un <strong>MAE</strong> cerca de 0.0944. El mejor desempeño se alcanza con el alpha mínimo evaluado, <strong>0.001</strong>, lo que indica que el modelo obtiene un buen ajuste incluso con <strong>regularización casi nula</strong>, es decir, prácticamente sin penalización sobre los coeficientes. A medida que la penalización aumenta (<span class="math notranslate nohighlight">\( \alpha \ge 100 \)</span>), el desempeño comienza a deteriorarse, reflejando que la regularización excesiva provoca que el modelo pierda capacidad para capturar la variabilidad de los datos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best_row</span> <span class="o">=</span> <span class="n">resultados_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">resultados_df</span><span class="p">[</span><span class="s2">&quot;R2_val&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()]</span>
<span class="n">best_alpha</span> <span class="o">=</span> <span class="n">best_row</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">]</span>
<span class="n">ridge_final</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">best_alpha</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">ridge_final</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">y_pred_train</span> <span class="o">=</span> <span class="n">ridge_final</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">)</span>
<span class="n">y_pred_test</span> <span class="o">=</span> <span class="n">ridge_final</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)</span>

<span class="n">resultados_eval</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Conjunto&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Entrenamiento&quot;</span><span class="p">,</span> <span class="s2">&quot;Prueba&quot;</span><span class="p">],</span>
    <span class="s2">&quot;R2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred_train</span><span class="p">),</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_test</span><span class="p">)],</span>
    <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred_train</span><span class="p">)),</span>
        <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_test</span><span class="p">))</span>
    <span class="p">],</span>
    <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred_train</span><span class="p">),</span>
        <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_test</span><span class="p">)</span>
    <span class="p">]</span>
<span class="p">})</span>

<span class="n">overfitting_r2</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">resultados_eval</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;R2&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">resultados_eval</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;R2&quot;</span><span class="p">])</span>
<span class="n">resultados_eval</span><span class="p">[</span><span class="s2">&quot;Overfitting_R2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">overfitting_r2</span><span class="p">,</span> <span class="n">overfitting_r2</span><span class="p">]</span>
<span class="n">resultados_eval_ridge</span> <span class="o">=</span> <span class="n">resultados_eval</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">resultados_eval_ridge</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Conjunto</th>
      <th>R2</th>
      <th>RMSE</th>
      <th>MAE</th>
      <th>Overfitting_R2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Entrenamiento</td>
      <td>0.848455</td>
      <td>0.146216</td>
      <td>0.102406</td>
      <td>0.00699</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Prueba</td>
      <td>0.855445</td>
      <td>0.145359</td>
      <td>0.105501</td>
      <td>0.00699</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Tabla 8.2.3.</strong> Resumen evaluación Ridge.</p>
<p>El modelo muestra un desempeño sólido tanto en el conjunto de entrenamiento como en el de prueba. En el conjunto de entrenamiento, el <strong>R²</strong> es 0.8485, con un <strong>RMSE</strong> de 0.1462 y un <strong>MAE</strong> de 0.1024, mientras que en el conjunto de prueba el <strong>R²</strong> aumenta ligeramente a 0.8554, con un <strong>RMSE</strong> de 0.1454 y un <strong>MAE</strong> de 0.1055. Además, la diferencia absoluta entre el R² de entrenamiento y prueba es muy baja (0.00699), lo que indica que el modelo generaliza de manera adecuada a datos no vistos.</p>
</section>
<section id="regresion-lasso">
<h2>8.3 Regresión Lasso<a class="headerlink" href="#regresion-lasso" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Lasso</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">r2_score</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_error</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../data/AmesHousing_codificada.csv&quot;</span><span class="p">)</span>

<span class="n">vars_modelo</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;Overall Qual&#39;</span><span class="p">,</span> <span class="s1">&#39;Gr Liv Area&#39;</span><span class="p">,</span> <span class="s1">&#39;Garage Cars&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Total Bsmt SF&#39;</span><span class="p">,</span> <span class="s1">&#39;1st Flr SF&#39;</span><span class="p">,</span> <span class="s1">&#39;Full Bath&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Year Built&#39;</span><span class="p">,</span> <span class="s1">&#39;Fireplaces&#39;</span><span class="p">,</span> <span class="s1">&#39;Lot Area&#39;</span>
<span class="p">]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">vars_modelo</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;SalePrice_log&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_train_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">X_train_int</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train_int</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tamaños -&gt; Train interno: </span><span class="si">{</span><span class="n">X_train_int</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, Validación: </span><span class="si">{</span><span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, Test final: </span><span class="si">{</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tamaños -&gt; Train interno: 1549, Validación: 388, Test final: 831
</pre></div>
</div>
</div>
</div>
<p><strong>Tabla 8.3.1.</strong> Tamaños validación Lasso.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>  <span class="c1"># 10^-3 a 10^0</span>
<span class="n">resultados</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">alphas</span><span class="p">:</span>
    <span class="n">lasso</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
    <span class="n">lasso</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_int</span><span class="p">,</span> <span class="n">y_train_int</span><span class="p">)</span>
    
    <span class="n">y_val_pred</span> <span class="o">=</span> <span class="n">lasso</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
    <span class="n">r2_val</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred</span><span class="p">)</span>
    <span class="n">rmse_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred</span><span class="p">))</span>
    <span class="n">mae_val</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred</span><span class="p">)</span>
    
    <span class="n">resultados</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">alpha</span><span class="p">,</span> <span class="n">r2_val</span><span class="p">,</span> <span class="n">rmse_val</span><span class="p">,</span> <span class="n">mae_val</span><span class="p">))</span>

<span class="n">resultados_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">,</span> <span class="s2">&quot;R2_val&quot;</span><span class="p">,</span> <span class="s2">&quot;RMSE_val&quot;</span><span class="p">,</span> <span class="s2">&quot;MAE_val&quot;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">resultados_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>alpha</th>
      <th>R2_val</th>
      <th>RMSE_val</th>
      <th>MAE_val</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.001000</td>
      <td>0.885675</td>
      <td>0.123951</td>
      <td>0.094331</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.002154</td>
      <td>0.885613</td>
      <td>0.123985</td>
      <td>0.094362</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.004642</td>
      <td>0.885717</td>
      <td>0.123929</td>
      <td>0.094275</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.010000</td>
      <td>0.885189</td>
      <td>0.124215</td>
      <td>0.094409</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.021544</td>
      <td>0.880562</td>
      <td>0.126693</td>
      <td>0.095797</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.046416</td>
      <td>0.854400</td>
      <td>0.139882</td>
      <td>0.105517</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.100000</td>
      <td>0.750039</td>
      <td>0.183281</td>
      <td>0.141364</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.215443</td>
      <td>0.366460</td>
      <td>0.291788</td>
      <td>0.229378</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.464159</td>
      <td>-0.000546</td>
      <td>0.366690</td>
      <td>0.290049</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1.000000</td>
      <td>-0.000546</td>
      <td>0.366690</td>
      <td>0.290049</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Tabla 8.3.2.</strong> Evaluación de valores de penalización Lasso.</p>
<p>Al evaluar el modelo Lasso, se observa que para valores pequeños de <span class="math notranslate nohighlight">\( \alpha\ \)</span> (0.001 a 0.01), las métricas de validación son óptimas, con un <strong>R²</strong> cercano a 0.8857, un <strong>RMSE</strong> alrededor de 0.1239 y un <strong>MAE</strong> cerca de 0.0943, indicando un ajuste sólido a los datos de validación.</p>
<p>A medida que alpha aumenta (<span class="math notranslate nohighlight">\( \alpha \ge 0.02 \)</span>), el desempeño del modelo comienza a deteriorarse: R² disminuye, mientras que RMSE y MAE aumentan, de forma que Lasso alcanza su mejor desempeño prácticamente sin regularización, similar a lo observado con Ridge, y que valores grandes de alpha producen subajuste.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best_row</span> <span class="o">=</span> <span class="n">resultados_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">resultados_df</span><span class="p">[</span><span class="s2">&quot;R2_val&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()]</span>
<span class="n">best_alpha</span> <span class="o">=</span> <span class="n">best_row</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">]</span>

<span class="n">lasso_final</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">best_alpha</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">lasso_final</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">coeficientes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Variable&quot;</span><span class="p">:</span> <span class="n">vars_modelo</span><span class="p">,</span>
    <span class="s2">&quot;Coeficiente&quot;</span><span class="p">:</span> <span class="n">lasso_final</span><span class="o">.</span><span class="n">coef_</span>
<span class="p">})</span>
<span class="n">coeficientes</span><span class="p">[</span><span class="s2">&quot;Es_cero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">coeficientes</span><span class="p">[</span><span class="s2">&quot;Coeficiente&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span>
<span class="n">display</span><span class="p">(</span><span class="n">coeficientes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable</th>
      <th>Coeficiente</th>
      <th>Es_cero</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Overall Qual</td>
      <td>0.138222</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Gr Liv Area</td>
      <td>0.095902</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Garage Cars</td>
      <td>0.036447</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Total Bsmt SF</td>
      <td>0.060118</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1st Flr SF</td>
      <td>0.000000</td>
      <td>True</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Full Bath</td>
      <td>0.000000</td>
      <td>True</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Year Built</td>
      <td>0.075296</td>
      <td>False</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Fireplaces</td>
      <td>0.025916</td>
      <td>False</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Lot Area</td>
      <td>0.038364</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Tabla 8.3.3.</strong> Coeficientes Lasso.</p>
<p>Se muestra que la regresión Lasso ha reducido algunos coeficientes a cero, lo que refleja su capacidad de realizar selección automática de variables mediante la regularización L1. Específicamente, las variables <code class="docutils literal notranslate"><span class="pre">1st</span> <span class="pre">Flr</span> <span class="pre">SF</span></code> y <code class="docutils literal notranslate"><span class="pre">Full</span> <span class="pre">Bath</span></code> tienen coeficiente 0, lo que indica que el modelo las considera no relevantes para predecir <code class="docutils literal notranslate"><span class="pre">SalePrice_log</span></code> en presencia de las otras variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred_train</span> <span class="o">=</span> <span class="n">lasso_final</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">)</span>
<span class="n">y_pred_test</span> <span class="o">=</span> <span class="n">lasso_final</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)</span>

<span class="n">resultados_eval</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Conjunto&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Entrenamiento&quot;</span><span class="p">,</span> <span class="s2">&quot;Prueba&quot;</span><span class="p">],</span>
    <span class="s2">&quot;R2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred_train</span><span class="p">),</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_test</span><span class="p">)],</span>
    <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred_train</span><span class="p">)),</span>
             <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_test</span><span class="p">))],</span>
    <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred_train</span><span class="p">),</span>
            <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_test</span><span class="p">)]</span>
<span class="p">})</span>

<span class="n">overfitting_r2</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">resultados_eval</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;R2&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">resultados_eval</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;R2&quot;</span><span class="p">])</span>
<span class="n">resultados_eval</span><span class="p">[</span><span class="s2">&quot;Overfitting_R2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">overfitting_r2</span><span class="p">,</span> <span class="n">overfitting_r2</span><span class="p">]</span>

<span class="n">resultados_eval_lasso</span> <span class="o">=</span> <span class="n">resultados_eval</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">resultados_eval_lasso</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Conjunto</th>
      <th>R2</th>
      <th>RMSE</th>
      <th>MAE</th>
      <th>Overfitting_R2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Entrenamiento</td>
      <td>0.847851</td>
      <td>0.146507</td>
      <td>0.102441</td>
      <td>0.008724</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Prueba</td>
      <td>0.856575</td>
      <td>0.144790</td>
      <td>0.105277</td>
      <td>0.008724</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Tabla 8.3.4.</strong> Resumen evaluación Lasso.</p>
<p>En el <strong>conjunto de entrenamiento</strong>, el <strong>R²</strong> es 0.8479, con un <strong>RMSE</strong> de 0.1465 y un <strong>MAE</strong> de 0.1024. En el <strong>conjunto de prueba</strong>, el <strong>R²</strong> aumenta ligeramente a 0.8566, con un <strong>RMSE</strong> de 0.1448 y un <strong>MAE</strong> de 0.1053. La diferencia absoluta entre el R² de entrenamiento y prueba, es baja (0.0087), lo que indica que el modelo <strong>no presenta sobreajuste significativo</strong> y generaliza correctamente a datos no vistos.</p>
<p>En conjunto, estas métricas confirman que el modelo Lasso logra un ajuste consistente y preciso, con la ventaja adicional de haber reducido algunos coeficientes a cero, mejorando la interpretabilidad del modelo.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="ols-vs-ridge-vs-lasso">
<h1>8.4 OLS vs. Ridge vs. Lasso<a class="headerlink" href="#ols-vs-ridge-vs-lasso" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comparativa</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Modelo&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;OLS&quot;</span><span class="p">,</span> <span class="s2">&quot;Ridge&quot;</span><span class="p">,</span> <span class="s2">&quot;Lasso&quot;</span><span class="p">],</span>
    <span class="s2">&quot;R2_Test&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">resultados_eval_ols</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">resultados_eval_ols</span><span class="p">[</span><span class="s2">&quot;Conjunto&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Prueba&quot;</span><span class="p">,</span> <span class="s2">&quot;R2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">resultados_eval_ridge</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">resultados_eval_ridge</span><span class="p">[</span><span class="s2">&quot;Conjunto&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Prueba&quot;</span><span class="p">,</span> <span class="s2">&quot;R2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">resultados_eval_lasso</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">resultados_eval_lasso</span><span class="p">[</span><span class="s2">&quot;Conjunto&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Prueba&quot;</span><span class="p">,</span> <span class="s2">&quot;R2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="p">],</span>
    <span class="s2">&quot;RMSE_Test&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">resultados_eval_ols</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">resultados_eval_ols</span><span class="p">[</span><span class="s2">&quot;Conjunto&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Prueba&quot;</span><span class="p">,</span> <span class="s2">&quot;RMSE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">resultados_eval_ridge</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">resultados_eval_ridge</span><span class="p">[</span><span class="s2">&quot;Conjunto&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Prueba&quot;</span><span class="p">,</span> <span class="s2">&quot;RMSE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">resultados_eval_lasso</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">resultados_eval_lasso</span><span class="p">[</span><span class="s2">&quot;Conjunto&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Prueba&quot;</span><span class="p">,</span> <span class="s2">&quot;RMSE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="p">],</span>
    <span class="s2">&quot;MAE_Test&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">resultados_eval_ols</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">resultados_eval_ols</span><span class="p">[</span><span class="s2">&quot;Conjunto&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Prueba&quot;</span><span class="p">,</span> <span class="s2">&quot;MAE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">resultados_eval_ridge</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">resultados_eval_ridge</span><span class="p">[</span><span class="s2">&quot;Conjunto&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Prueba&quot;</span><span class="p">,</span> <span class="s2">&quot;MAE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">resultados_eval_lasso</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">resultados_eval_lasso</span><span class="p">[</span><span class="s2">&quot;Conjunto&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Prueba&quot;</span><span class="p">,</span> <span class="s2">&quot;MAE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="p">],</span>
    <span class="s2">&quot;Overfitting_R2&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">resultados_eval_ols</span><span class="p">[</span><span class="s2">&quot;Overfitting_R2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">resultados_eval_ridge</span><span class="p">[</span><span class="s2">&quot;Overfitting_R2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">resultados_eval_lasso</span><span class="p">[</span><span class="s2">&quot;Overfitting_R2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="p">]</span>
<span class="p">})</span>

<span class="n">display</span><span class="p">(</span>
    <span class="n">comparativa</span><span class="o">.</span><span class="n">style</span>
    <span class="o">.</span><span class="n">format</span><span class="p">({</span>
        <span class="s2">&quot;R2_Test&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;RMSE_Test&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;MAE_Test&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Overfitting_R2&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span>
    <span class="p">})</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_ae74f">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_ae74f_level0_col0" class="col_heading level0 col0" >Modelo</th>
      <th id="T_ae74f_level0_col1" class="col_heading level0 col1" >R2_Test</th>
      <th id="T_ae74f_level0_col2" class="col_heading level0 col2" >RMSE_Test</th>
      <th id="T_ae74f_level0_col3" class="col_heading level0 col3" >MAE_Test</th>
      <th id="T_ae74f_level0_col4" class="col_heading level0 col4" >Overfitting_R2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_ae74f_level0_row0" class="row_heading level0 row0" >0</th>
      <td id="T_ae74f_row0_col0" class="data row0 col0" >OLS</td>
      <td id="T_ae74f_row0_col1" class="data row0 col1" >0.8553</td>
      <td id="T_ae74f_row0_col2" class="data row0 col2" >0.1455</td>
      <td id="T_ae74f_row0_col3" class="data row0 col3" >0.1056</td>
      <td id="T_ae74f_row0_col4" class="data row0 col4" >-0.0068</td>
    </tr>
    <tr>
      <th id="T_ae74f_level0_row1" class="row_heading level0 row1" >1</th>
      <td id="T_ae74f_row1_col0" class="data row1 col0" >Ridge</td>
      <td id="T_ae74f_row1_col1" class="data row1 col1" >0.8554</td>
      <td id="T_ae74f_row1_col2" class="data row1 col2" >0.1454</td>
      <td id="T_ae74f_row1_col3" class="data row1 col3" >0.1055</td>
      <td id="T_ae74f_row1_col4" class="data row1 col4" >0.0070</td>
    </tr>
    <tr>
      <th id="T_ae74f_level0_row2" class="row_heading level0 row2" >2</th>
      <td id="T_ae74f_row2_col0" class="data row2 col0" >Lasso</td>
      <td id="T_ae74f_row2_col1" class="data row2 col1" >0.8566</td>
      <td id="T_ae74f_row2_col2" class="data row2 col2" >0.1448</td>
      <td id="T_ae74f_row2_col3" class="data row2 col3" >0.1053</td>
      <td id="T_ae74f_row2_col4" class="data row2 col4" >0.0087</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p><strong>Tabla 8.4.1.</strong> Métricas de evaluación OLS vs. Ridge vs. Lasso.</p>
<p>Todos los modelos presentan valores de R² muy similares, alrededor de 0.855–0.857, indicando que los tres explican aproximadamente el 85–86% de la variabilidad de los datos de prueba. Los errores de predicción son también comparables entre los modelos, con RMSE ≈ 0.145 y MAE ≈ 0.105.</p>
<p>En el caso de estudio Lasso logra el valor ligeramente más bajo en ambas métricas, sugiriendo un ajuste marginalmente más preciso. Además, simplifica el modelo al eliminar variables menos relevantes, mejorando la interpretabilidad sin sacrificar precisión.</p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="C7.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Capítulo 7: Remedios y métodos robustos</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Capítulo 8: Validación y selección del modelo</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#validacion-train-test">8.1 Validación train/test</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-ridge">8.2 Regresión Ridge</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-lasso">8.3 Regresión Lasso</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ols-vs-ridge-vs-lasso">8.4 OLS vs. Ridge vs. Lasso</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Daniel Carbono - Gloria Bastidas - Luis Perez
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>